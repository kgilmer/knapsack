<?xml version="1.0"?>
<project name="Knapsack" default="jar">
	<property name="wget.bin" location="/usr/bin/wget" />
	<property name="svn.bin" location="/usr/bin/svn" />
	
	<property name="felix.framework.version" value="3.2.2" />
	
    <target name="clean" description="remove intermediate files">
        <delete dir="classes"/>
    	<delete dir="external"/>
    </target>
	
    <target name="clobber" depends="clean" description="remove all artifact files">
        <delete file="${ant.project.name}.jar"/>
    </target>
	
	<target name="fetch">
		<mkdir dir="external"/>
		
		<exec executable="${svn.bin}">
			<arg value="export" />
			<arg value="http://svn.apache.org/repos/asf/felix/releases/org.apache.felix.framework=${felix.framework.version}" />
			<arg value="external" />
		</exec>
		
	</target>
	
	<target name="stage">
	</target>
	
    <target name="compile" depends="fetch, stage" description="compile the Java source code to class files">
        <mkdir dir="classes"/>
        <javac srcdir="." destdir="classes"/>
    </target>
	
    <target name="jar" depends="compile" description="create a Jar file for the application">
    	<mkdir dir="classes/scripts"/>
    	<copy toDir="classes/scripts/">
    		<fileset dir="scripts" />
    	</copy>
        <jar destfile="${ant.project.name}.jar" manifest="META-INF/MANIFEST.MF">
            <fileset dir="classes" includes="**/*.class,**/*.sh"/>        	    
        	<filename name="LICENSE-2.0.txt"/>
        </jar>
    </target>
</project>